# ============================================================================
# Cloud Database Configuration Examples
# Copy this file to .env and configure for your cloud provider
# ============================================================================

# ============================================================================
# COMMON SETTINGS (All Cloud Providers)
# ============================================================================

NODE_ENV=production
CLOUD_DATABASE=true

# Database Connection Pool Settings (optimize for your cloud provider)
POOL_MIN=2
POOL_MAX=20
POOL_IDLE_TIMEOUT=30000
POOL_CONNECTION_TIMEOUT=20000

# SSL (Required for most cloud databases)
POSTGRES_SSL=true

# ============================================================================
# AWS RDS POSTGRESQL
# ============================================================================

# For AWS RDS, use either:
# Option 1: Individual parameters
POSTGRES_HOST=your-db-instance.rds.amazonaws.com
POSTGRES_PORT=5432
POSTGRES_USER=your_db_user
POSTGRES_PASSWORD=your_secure_password
POSTGRES_DB=your_database_name

# Option 2: Connection string (preferred)
DATABASE_URL=postgresql://username:password@your-db-instance.rds.amazonaws.com:5432/your_database_name?sslmode=require

# AWS-specific optimizations
POOL_MAX=50  # RDS can handle more connections
POOL_CONNECTION_TIMEOUT=30000  # RDS can be slower during failover

# ============================================================================
# GOOGLE CLOUD SQL POSTGRESQL
# ============================================================================

# For Google Cloud SQL, use connection string:
DATABASE_URL=postgresql://username:password@your-project:your-region:your-instance/your_database_name?sslmode=require

# Alternative: Using proxy
POSTGRES_HOST=127.0.0.1  # When using Cloud SQL proxy
POSTGRES_PORT=5432
POSTGRES_USER=your_db_user
POSTGRES_PASSWORD=your_password
POSTGRES_DB=your_database_name

# Cloud SQL optimizations
POOL_MAX=25
POOL_IDLE_TIMEOUT=60000  # Cloud SQL keeps connections alive longer

# ============================================================================
# AZURE DATABASE FOR POSTGRESQL
# ============================================================================

# Azure Database connection
DATABASE_URL=postgresql://username@servername:password@servername.postgres.database.azure.com:5432/your_database_name?sslmode=require

# Azure-specific settings
POOL_MAX=30
POOL_CONNECTION_TIMEOUT=25000

# ============================================================================
# DIGITALOCEAN MANAGED DATABASES
# ============================================================================

# DigitalOcean connection
DATABASE_URL=postgresql://doadmin:password@your-db-host/db?sslmode=require

# DigitalOcean optimizations
POOL_MAX=15
POOL_IDLE_TIMEOUT=45000

# ============================================================================
# SUPABASE
# ============================================================================

# Supabase connection
DATABASE_URL=postgresql://postgres:password@db.your-project.supabase.co:5432/postgres

# Supabase optimizations (has connection limits)
POOL_MAX=15
POOL_MIN=1
POOL_IDLE_TIMEOUT=30000

# ============================================================================
# NEON
# ============================================================================

# Neon connection
DATABASE_URL=postgresql://username:password@ep-xxx.us-east-1.neon.tech/dbname?sslmode=require

# Neon optimizations
POOL_MAX=20
POOL_IDLE_TIMEOUT=60000  # Neon keeps connections alive longer

# ============================================================================
# OTHER CLOUD PROVIDERS (PlanetScale, Railway, Render, etc.)
# ============================================================================

# Most cloud providers support standard PostgreSQL connection strings
DATABASE_URL=postgresql://username:password@host:port/database?sslmode=require

# Generic cloud optimizations
POOL_MAX=20
POOL_MIN=2
POOL_IDLE_TIMEOUT=30000
POOL_CONNECTION_TIMEOUT=20000

# ============================================================================
# ADMIN USER CONFIGURATION
# ============================================================================

# Admin user creation (optional - only needed for initial setup)
ADMIN_SEED_EMAIL=admin@yourcompany.com
ADMIN_SEED_PASSWORD=secure_password_here
ADMIN_SEED_NAME="Super Admin"

# ============================================================================
# MONITORING AND LOGGING
# ============================================================================

# Enable detailed database logging (for debugging)
DATABASE_LOG_QUERIES=false
DATABASE_LOG_SLOW_QUERIES=true
DATABASE_SLOW_QUERY_THRESHOLD=1000  # ms

# ============================================================================
# BACKUP AND MAINTENANCE
# ============================================================================

# Backup configuration (implement in your deployment)
DB_BACKUP_ENABLED=true
DB_BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM UTC
DB_BACKUP_RETENTION_DAYS=30

# Maintenance windows (for cloud providers that support it)
DB_MAINTENANCE_WINDOW="sun:03:00-sun:05:00"  # UTC time

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# Database security
DB_ENCRYPTION_ENABLED=true
DB_SSL_MODE=require  # require, prefer, allow, disable

# Connection security
DB_ALLOW_UNENCRYPTED_CONNECTIONS=false
DB_FORCE_SSL=true

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================

# Query optimization
DB_QUERY_TIMEOUT=30000  # 30 seconds
DB_STATEMENT_TIMEOUT=30000
DB_IDLE_IN_TRANSACTION_TIMEOUT=30000

# Connection optimization
DB_KEEP_ALIVE=true
DB_KEEP_ALIVE_DELAY=0
DB_TCP_KEEP_ALIVE=true

# ============================================================================
# HIGH AVAILABILITY (For providers that support it)
# ============================================================================

# Read replica configuration (if available)
DB_READ_REPLICA_ENABLED=false
DB_READ_REPLICA_HOST=your-read-replica-host
DB_READ_REPLICA_PORT=5432

# Connection failover
DB_FAILOVER_ENABLED=true
DB_FAILOVER_TIMEOUT=30000

# ============================================================================
# CLOUD-SPECIFIC FEATURES
# ============================================================================

# AWS RDS specific
AWS_REGION=us-east-1
AWS_RDS_INSTANCE_IDENTIFIER=your-db-instance
AWS_RDS_CLUSTER_IDENTIFIER=your-cluster  # For Aurora

# Google Cloud SQL specific
GOOGLE_CLOUD_PROJECT=your-project-id
GOOGLE_CLOUD_REGION=us-central1
GOOGLE_CLOUD_INSTANCE=your-instance-name

# Azure specific
AZURE_SUBSCRIPTION_ID=your-subscription-id
AZURE_RESOURCE_GROUP=your-resource-group
AZURE_SERVER_NAME=your-server-name

# ============================================================================
# MONITORING AND ALERTS
# ============================================================================

# Health check configuration
DB_HEALTH_CHECK_ENABLED=true
DB_HEALTH_CHECK_INTERVAL=30000  # 30 seconds
DB_HEALTH_CHECK_TIMEOUT=5000    # 5 seconds

# Alert thresholds
DB_CONNECTION_WARNING_THRESHOLD=80  # Percentage
DB_RESPONSE_TIME_WARNING_THRESHOLD=1000  # ms

# ============================================================================
# DEVELOPMENT OVERRIDES (for local development)
# ============================================================================

# Uncomment these for local development (will override cloud settings)
# NODE_ENV=development
# CLOUD_DATABASE=false
# DATABASE_URL=postgresql://postgres:password@localhost:5432/kodingcaravan
# POSTGRES_SSL=false
